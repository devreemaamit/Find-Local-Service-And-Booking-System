{% extends 'base.html' %}
{% block title %}Browse Services{% endblock %}

{% block content %}
<div class="container mt-4">

<div class="d-flex justify-content-between align-items-center mb-4">
  
  <h3 class="text-primary m-0">Browse Services</h3>

  <button onclick="history.back()"
          class="btn btn-outline-secondary btn-sm">
    ← Back
  </button>

</div>

<form method="get" class="mb-4">
  <div class="input-group">

    <input type="text"
           name="q"
           class="form-control"
           placeholder="Search services..."
           value="{{ request.GET.q }}">

    <button type="submit" class="btn btn-primary">
      Search
    </button>

    {% if request.GET.q %}
    <a href="{% url 'service_list' %}"
       class="btn btn-secondary">
       Clear
    </a>
    {% endif %}

  </div>
</form>


<div class="row">

{% for service in services %}
  <div class="col-md-4 mb-4">
    <div class="card shadow-sm h-100">
      <div class="card-body">

        <h5 class="card-title">{{ service.service_name }}</h5>

        <p class="text-muted">
          {{ service.description|truncatewords:15 }}
        </p>

        <p>
          {% if service.avg_rating %}
            ⭐ {{ service.avg_rating|floatformat:1 }}
          {% else %}
            ⭐ No rating yet
          {% endif %}
        </p>

        <p class="fw-bold text-success">
          ₹ {{ service.price }}
        </p>

        <hr class="my-2">

        <!--  Provider Details (Added, UI same style) -->
        <p class="mb-1 small">
          <strong>Provider:</strong> {{ service.provider.full_name }}
        </p>

        <p class="mb-1 small">
          <strong>Mobile:</strong>
          {{ service.provider.contact_number|default:"Not available" }}
        </p>

        <p class="mb-2 small">
          <strong>Address:</strong>
          {{ service.provider.address|default:"Not available" }}
        </p>

        <a href="{% url 'service_detail' service.id %}"
           class="btn btn-outline-primary w-100">
           View Details
        </a>

      </div>
    </div>
  </div>
{% empty %}
  <p>No services found.</p>
{% endfor %}

</div>

</div>
{% endblock %}
